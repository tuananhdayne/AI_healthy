<div class="admin-container">
  <!-- Sidebar Navigation -->
  <aside class="admin-sidebar">
    <div class="sidebar-header">
      <h2>Admin Panel</h2>
      <p class="admin-email">{{ currentAdminUser?.email }}</p>
    </div>
    <nav class="sidebar-nav">
      <button
        class="nav-item"
        [class.active]="activeTab === 'ai'"
        (click)="setActiveTab('ai')"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="1"></circle>
          <circle cx="19" cy="12" r="1"></circle>
          <circle cx="5" cy="12" r="1"></circle>
        </svg>
        <span>Qu·∫£n L√Ω AI</span>
      </button>
      <button
        class="nav-item"
        [class.active]="activeTab === 'users'"
        (click)="setActiveTab('users')"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <span>Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</span>
      </button>
      <button
        class="nav-item"
        [class.active]="activeTab === 'analytics'"
        (click)="setActiveTab('analytics')"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="12" y1="2" x2="12" y2="22"></line>
          <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
        </svg>
        <span>Th·ªëng K√™</span>
      </button>
      <button
        class="nav-item"
        [class.active]="activeTab === 'settings'"
        (click)="setActiveTab('settings')"
      >
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v6m0 6v6M4.22 4.22l4.24 4.24m5.08 5.08l4.24 4.24M1 12h6m6 0h6M4.22 19.78l4.24-4.24m5.08-5.08l4.24-4.24"></path>
        </svg>
        <span>C√†i ƒê·∫∑t</span>
      </button>
    </nav>
    <div class="sidebar-footer">
      <button class="logout-btn" (click)="logout()">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 8 20 12 16 16"></polyline>
          <line x1="9" y1="12" x2="20" y2="12"></line>
        </svg>
        <span>ƒêƒÉng Xu·∫•t</span>
      </button>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="admin-content">
    <!-- AI Management Tab -->
    <section class="tab-content" *ngIf="activeTab === 'ai'">
      <div class="section-header">
        <h2>Qu·∫£n L√Ω M√¥ H√¨nh AI</h2>
        <p>Th√™m, ch·ªânh s·ª≠a ho·∫∑c x√≥a c√°c m√¥ h√¨nh AI</p>
      </div>

      <div class="form-section">
        <h3>Th√™m M√¥ H√¨nh AI M·ªõi</h3>
        <form [formGroup]="aiForm" (ngSubmit)="addAIModel()" class="ai-form">
          <div class="form-row">
            <div class="form-group">
              <label>T√™n M√¥ H√¨nh</label>
              <input type="text" formControlName="modelName" placeholder="e.g., GPT-4" />
            </div>
            <div class="form-group">
              <label>API Key</label>
              <input type="password" formControlName="apiKey" placeholder="sk-..." />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label>Max Tokens</label>
              <input type="number" formControlName="maxTokens" placeholder="8000" />
            </div>
            <div class="form-group">
              <label>Tr·∫°ng Th√°i</label>
              <select formControlName="status">
                <option value="active">Ho·∫°t ƒê·ªông</option>
                <option value="inactive">T·∫°m D·ª´ng</option>
              </select>
            </div>
          </div>
          <button type="submit" class="btn btn-primary" [disabled]="aiForm.invalid">
            Th√™m M√¥ H√¨nh
          </button>
        </form>
      </div>

      <div class="models-list">
        <h3>C√°c M√¥ H√¨nh Hi·ªán T·∫°i</h3>
        <div class="model-card" *ngFor="let model of aiModels">
          <div class="model-info">
            <h4>{{ model.name }}</h4>
            <p>API Key: <code>{{ model.apiKey }}</code></p>
            <p>Max Tokens: <code>{{ model.maxTokens }}</code></p>
            <span class="status-badge" [class.active]="model.status === 'active'">
              {{ model.status === 'active' ? 'Ho·∫°t ƒê·ªông' : 'T·∫°m D·ª´ng' }}
            </span>
          </div>
          <div class="model-actions">
            <button class="btn btn-sm btn-secondary" (click)="editAIModel(model)">
              Ch·ªânh S·ª≠a
            </button>
            <button class="btn btn-sm btn-danger" (click)="deleteAIModel(model.id)">
              X√≥a
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- User Management Tab -->
    <section class="tab-content" *ngIf="activeTab === 'users'">
      <div class="section-header">
        <h2>Qu·∫£n L√Ω Ng∆∞·ªùi D√πng</h2>
        <p>Qu·∫£n l√Ω ng∆∞·ªùi d√πng, vai tr√≤ v√† quy·ªÅn truy c·∫≠p</p>
      </div>

      <div class="users-table">
        <table>
          <thead>
            <tr>
              <th>Email</th>
              <th>T√™n</th>
              <th>Vai Tr√≤</th>
              <th>Tr·∫°ng Th√°i</th>
              <th>H√†nh ƒê·ªông</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let user of users" [class.inactive]="(user.status || 'active') === 'inactive'">
              <td>{{ user.email }}</td>
              <td>{{ user.username || user.email }}</td>
              <td>
                <span class="role-badge" [class.admin]="user.role === 'admin'">
                  {{ user.role === 'admin' ? 'Admin' : 'User' }}
                </span>
              </td>
              <td>
                <span class="status-badge" [class.active]="(user.status || 'active') === 'active'">
                  {{ (user.status || 'active') === 'active' ? 'Ho·∫°t ƒê·ªông' : 'T·∫°m D·ª´ng' }}
                </span>
              </td>
              <td class="actions">
                <button
                  class="btn btn-sm btn-secondary"
                  (click)="toggleUserStatus(user.id || user.uid)"
                  [title]="(user.status || 'active') === 'active' ? 'V√¥ Hi·ªáu H√≥a' : 'K√≠ch Ho·∫°t'"
                >
                  {{ (user.status || 'active') === 'active' ? 'V√¥ Hi·ªáu' : 'K√≠ch Ho·∫°t' }}
                </button>
                <button
                  *ngIf="user.role === 'user'"
                  class="btn btn-sm btn-success"
                  (click)="promoteToAdmin(user.id || user.uid)"
                >
                  TƒÉng C·∫•p
                </button>
                <button
                  *ngIf="user.role === 'admin' && ((user.uid || user.id) !== currentAdminUser?.id)"
                  class="btn btn-sm btn-warning"
                  (click)="demoteFromAdmin(user.id || user.uid)"
                >
                  H·∫° C·∫•p
                </button>
                <button
                  class="btn btn-sm btn-danger"
                  (click)="removeUser(user.id || user.uid)"
                  [disabled]="(user.uid || user.id) === currentAdminUser?.id"
                >
                  X√≥a
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Analytics Tab -->
    <section class="tab-content" *ngIf="activeTab === 'analytics'">
      <div class="section-header">
        <h2>Th·ªëng K√™ & Ph√¢n T√≠ch</h2>
        <p>Xem t·ªïng quan v·ªÅ ho·∫°t ƒë·ªông h·ªá th·ªëng</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-label">T·ªïng Ng∆∞·ªùi D√πng</div>
          <div class="stat-value">{{ analytics.totalUsers }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Cu·ªôc Chat Ho·∫°t ƒê·ªông</div>
          <div class="stat-value">{{ analytics.activeChats }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">T·ªïng Y√™u C·∫ßu</div>
          <div class="stat-value">{{ analytics.totalRequests }}</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">Th·ªùi Gian Ph·∫£n H·ªìi Trung B√¨nh</div>
          <div class="stat-value">{{ analytics.avgResponseTime }}</div>
        </div>
      </div>

      <div class="chart-placeholder">
        <p>üìä Bi·ªÉu ƒë·ªì chi ti·∫øt s·∫Ω ƒë∆∞·ª£c th√™m sau</p>
      </div>
    </section>

    <!-- Settings Tab -->
    <section class="tab-content" *ngIf="activeTab === 'settings'">
      <div class="section-header">
        <h2>C√†i ƒê·∫∑t H·ªá Th·ªëng</h2>
        <p>Qu·∫£n l√Ω c·∫•u h√¨nh to√†n h·ªá th·ªëng</p>
      </div>

      <div class="settings-form">
        <div class="form-group">
          <label>T√™n ·ª®ng D·ª•ng</label>
          <input type="text" value="GiaDienWeb AI" />
        </div>
        <div class="form-group">
          <label>URL C∆° S·ªü API</label>
          <input type="text" value="https://api.example.com" />
        </div>
        <div class="form-group">
          <label>Cho Ph√©p ƒêƒÉng K√Ω Ng∆∞·ªùi D√πng M·ªõi</label>
          <select>
            <option>C√≥</option>
            <option>Kh√¥ng</option>
          </select>
        </div>
        <div class="form-group">
          <label>L·ªãch S·ª≠ Chat T·ªëi ƒêa (Ng√†y)</label>
          <input type="number" value="30" />
        </div>
        <button class="btn btn-primary" (click)="saveAdminSettings()">
          L∆∞u C√†i ƒê·∫∑t
        </button>
      </div>
    </section>
  </main>
</div>
